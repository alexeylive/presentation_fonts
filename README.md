# Анализатор шрифтов для презентаций

Инструмент на Google Apps Script для анализа использования шрифтов в презентациях Google Slides с созданием сводной таблицы на первом слайде.

## Версии

- **FontAnalyzer.gs** - Основная версия
- **FontAnalyzerV2.gs** - Улучшенная версия с лучшим определением размеров шрифтов и обработкой ошибок

## Возможности

- Анализирует все текстовые элементы в презентациях Google Slides
- Собирает информацию о семействах шрифтов и их размерах на каждом слайде
- Поддерживает анализ определенного диапазона слайдов (от 1-го до указанного номера)
- Создает подробную сводную таблицу на первом слайде
- Обрабатывает текст в фигурах, текстовых полях и таблицах

## Установка

1. Откройте вашу презентацию в Google Slides
2. Перейдите в меню **Расширения** → **Apps Script**
3. Удалите весь существующий код в редакторе скриптов
4. Скопируйте содержимое файла `FontAnalyzer.gs` и вставьте его в редактор
5. Нажмите на кнопку **+** рядом с "Файлы" и выберите **HTML**
6. Назовите файл `dialog` (без расширения .html)
7. Скопируйте содержимое файла `dialog.html` и вставьте его в HTML-файл
8. Сохраните проект (Ctrl+S или Cmd+S)
9. Перезагрузите презентацию Google Slides

## Использование

### Способ 1: Через меню
1. После установки в вашей презентации появится новый пункт меню **Font Analyzer**
2. Нажмите **Font Analyzer** → **Analyze Fonts**
3. В диалоговом окне вы можете:
   - Оставить поле пустым для анализа всех слайдов
   - Ввести номер слайда, чтобы проанализировать слайды с 1-го по указанный
4. Нажмите кнопку **Analyze Fonts**
5. Скрипт проанализирует презентацию и создаст сводную таблицу на первом слайде

### Способ 2: Быстрый анализ
- Нажмите **Font Analyzer** → **Analyze All Slides** для быстрого анализа всех слайдов без диалогового окна

## Формат результатов

Инструмент создает таблицу на первом слайде со следующими колонками:
- **Slide #**: Номер слайда, где найдены шрифты
- **Font Family**: Название используемого шрифта
- **Font Sizes (pt)**: Все размеры данного шрифта на слайде (в пунктах)

Пример результата:
```
| Slide # | Font Family    | Font Sizes (pt) |
|---------|----------------|-----------------|
| Slide 1 | Arial          | 24, 36          |
| Slide 1 | Roboto         | 14, 18          |
| Slide 2 | Times New Roman| 12, 14, 16      |
```

## Примечания

- Скрипт анализирует только текст с явно заданными настройками шрифта
- Шрифты по умолчанию без конкретных настроек могут отображаться как "Default"
- Сводная таблица всегда размещается на первом слайде в позиции (10, 10)
- При повторном запуске скрипта будет добавлена новая таблица

## Решение проблем

### Общие проблемы:
1. Убедитесь, что у вас есть права на редактирование презентации
2. Проверьте, что оба файла (FontAnalyzer.gs и dialog.html) правильно сохранены
3. Попробуйте перезагрузить презентацию Google Slides
4. Проверьте редактор Apps Script на наличие сообщений об ошибках

### Если размеры шрифтов не отображаются:
- Используйте версию FontAnalyzerV2.gs, которая имеет улучшенное определение размеров
- Эта версия использует несколько методов для извлечения размера шрифта
- Если размер не может быть определен, используется значение по умолчанию (11pt)

### Если появляются пустые строки в таблице:
- Версия V2 фильтрует пустые текстовые элементы
- Проверяется наличие текста перед анализом

## Лицензия

Этот проект с открытым исходным кодом и доступен под лицензией MIT.