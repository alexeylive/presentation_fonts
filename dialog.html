<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .form-group {
        margin-bottom: 15px;
      }
      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
      }
      input[type="number"] {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
      }
      .button-group {
        margin-top: 20px;
        text-align: right;
      }
      button {
        padding: 8px 16px;
        margin-left: 10px;
        border: none;
        border-radius: 4px;
        font-size: 14px;
        cursor: pointer;
      }
      .primary-button {
        background-color: #4285f4;
        color: white;
      }
      .primary-button:hover {
        background-color: #357ae8;
      }
      .secondary-button {
        background-color: #f1f3f4;
        color: #5f6368;
      }
      .secondary-button:hover {
        background-color: #e8eaed;
      }
      .info {
        color: #5f6368;
        font-size: 12px;
        margin-top: 5px;
      }
    </style>
  </head>
  <body>
    <div class="form-group">
      <label for="endSlide">Analyze up to slide number:</label>
      <input type="number" id="endSlide" min="1" placeholder="Leave empty to analyze all slides">
      <p class="info">Enter a slide number to limit the analysis, or leave empty to analyze all slides in the presentation.</p>
    </div>
    
    <div class="button-group">
      <button class="secondary-button" onclick="google.script.host.close()">Cancel</button>
      <button class="primary-button" onclick="runAnalysis()">Analyze Fonts</button>
    </div>
    
    <script>
      function runAnalysis() {
        const endSlideInput = document.getElementById('endSlide');
        const endSlide = endSlideInput.value ? parseInt(endSlideInput.value) : null;
        
        // Disable buttons during processing
        const buttons = document.querySelectorAll('button');
        buttons.forEach(btn => btn.disabled = true);
        
        // Run the analysis
        google.script.run
          .withSuccessHandler(() => google.script.host.close())
          .withFailureHandler((error) => {
            alert('Error: ' + error);
            buttons.forEach(btn => btn.disabled = false);
          })
          .analyzeFonts(endSlide);
      }
      
      // Allow Enter key to submit
      document.getElementById('endSlide').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
          runAnalysis();
        }
      });
    </script>
  </body>
</html>